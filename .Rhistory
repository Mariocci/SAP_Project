knitr::opts_chunk$set(echo = TRUE)
options(repos = c(CRAN = "https://cloud.r-project.org"))
library(moments)
library(boot)
require(caret)
logreg.mdl = glm(zoo ~ churches + resorts + beaches + parks + theatres + museums + malls + restaurants + pubs.bars + burger.pizza.shops + hotels.other.lodgings + juice.bars + art.galleries + dance.clubs + swimming.pools + gyms + bakeries + beauty...spas + cafes + view.points + monuments + gardens, data = data, family = Gamma())
knitr::opts_chunk$set(echo = TRUE)
options(repos = c(CRAN = "https://cloud.r-project.org"))
library(moments)
library(boot)
# Ucitavanje podataka
data <- read.csv("google_review_ratings.csv")
data <- data[, -1]
data <- na.omit(data)
num_categories <- ncol(data)
require(caret)
logreg.mdl = glm(zoo ~ churches + resorts + beaches + parks + theatres + museums + malls + restaurants + pubs.bars + burger.pizza.shops + hotels.other.lodgings + juice.bars + art.galleries + dance.clubs + swimming.pools + gyms + bakeries + beauty...spas + cafes + view.points + monuments + gardens, data = data, family = Gamma())
summary(logreg.mdl)
Rsq = 1 - logreg.mdl$deviance/logreg.mdl$null.deviance
Rsq
logreg.mdl.2 = glm(zoo ~ churches + resorts + beaches + parks + theatres + museums + malls + restaurants + pubs.bars + burger.pizza.shops + hotels.other.lodgings + juice.bars + art.galleries + dance.clubs + swimming.pools + gyms + bakeries + beauty...spas + cafes + view.points + monuments + gardens + I(cafes/malls), data = data, family = Gamma())
summary(logreg.mdl.2)
anova(logreg.mdl, logreg.mdl.2, test = "LRT")
logreg.mdl.3 = glm(zoo ~ churches + beaches + parks + theatres + museums + malls + restaurants + pubs.bars + burger.pizza.shops + juice.bars + art.galleries + bakeries + beauty...spas + cafes + view.points + monuments + gardens, data = data, family = Gamma())
summary(logreg.mdl.3)
anova(logreg.mdl, logreg.mdl.3, test = "LRT")
Rsq = 1 - logreg.mdl.2$deviance/logreg.mdl.2$null.deviance
Rsq
knitr::opts_chunk$set(echo = TRUE)
options(repos = c(CRAN = "https://cloud.r-project.org"))
library(moments)
library(boot)
Rsq = 1 - logreg.mdl.2$deviance/logreg.mdl.2$null.deviance
Rsq
